# Журнал решений

| Дата (UTC) | Решение | Причина | Последствия |
|---|---|---|---|
| 2026-01-26 | Web UI встроен в backend (FastAPI static + SSE) | Минимизация сборки и точек отказа в демо‑scope | Один процесс обслуживает UI и API |
| 2026-01-26 | События доставки в web реализованы через SSE `/api/events` | Просто, работает в браузере без WebSocket инфраструктуры | Подходит для демо; при рестарте отдаётся last event |
| 2026-01-26 | LLM вызов через Ollama `/api/chat` с `format=json` | Упростить парсинг результата и контракт | Всё равно нужна валидация схемы |
| 2026-01-26 | Хранение фото из NFC на диске + путь в SQLite | Проще, чем BLOB в SQLite для демо | Данные лежат в `backend/data/files` |
| 2025-02-14 | LLMService остаётся stateless: request_id передаётся в методы, не хранится в экземпляре | Исключить утечки состояния между pipeline-запросами | Любое обращение к `LLMService.request_id` считается регрессией |
| 2025-02-14 | request_id обязателен в structured logs (placeholder `n/a` при отсутствии) | Единый контракт корреляции для control/data plane | Логи всегда содержат ключ request_id |
| 2026-01-28 | NFC декодирование вынесено на сервер (server-side decoding) | Уменьшение APK, централизация логики парсинга, возможность обновлять парсинг без релиза приложения | Мобилка отправляет raw DG1/DG2 bytes; сервер парсит ASN.1 через JMRTD; legacy формат сохранён для обратной совместимости |
